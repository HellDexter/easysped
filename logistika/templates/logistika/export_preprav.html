<!doctype html>
<html lang="cs">
<head>
    <meta charset="utf-8">
    <title>Nabídka volných přeprav</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table {
            border-collapse: collapse; /* Spojí okraje buněk */
            width: 100%;
            font-size: 14px;
        }
        th, td {
            border: 1px solid #cccccc; /* Tenký šedý okraj */
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2; /* Světle šedé pozadí hlavičky */
            font-weight: bold;
        }
    </style>
</head>
<body>

    <div style="display: flex; justify-content: space-between; align-items: center;">
        <h1>Nabídka volných přeprav</h1>
        <button id="copy-btn" style="padding: 10px 15px; font-size: 16px; cursor: pointer;">Kopírovat</button>
    </div>

    <table id="export-table">
        <thead>
            <tr>
                <th>Termín</th>
                <th>Nakládka</th>
                <th>Vykládka</th>
                <th>Typ vozidla</th>
                <th>Zboží</th>
            </tr>
        </thead>
        <tbody>
            {% for preprava in prepravy %}
            <tr>
                <td>Nakládka: {{ preprava.datum_cas_nakladky }}<br>Vykládka: {{ preprava.datum_cas_vykladky }}</td>
                <td>{{ preprava.misto_nakladky }}</td>
                <td>{{ preprava.misto_vykladky }}</td>
                <td>{{ preprava.get_typ_vozidla_display }}</td>
                <td>{{ preprava.popis_zbozi }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" style="text-align: center;">Aktuálně nejsou žádné volné přepravy k dispozici.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <script>
        document.getElementById('copy-btn').addEventListener('click', function() {
            const table = document.getElementById('export-table');
            const btn = this;

            // Vytvoření dočasného textového pole pro zkopírování HTML
            const textarea = document.createElement('textarea');
            textarea.style.position = 'fixed';
            textarea.style.left = '-9999px';
            textarea.innerHTML = table.outerHTML;
            document.body.appendChild(textarea);

            // Výběr a kopírování
            const range = document.createRange();
            range.selectNode(table);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);

            let copied = false;
            try {
                copied = document.execCommand('copy');
            } catch (err) {
                console.error('Kopírování selhalo', err);
            }

            // Úklid
            window.getSelection().removeAllRanges();
            document.body.removeChild(textarea);

            // Zpětná vazba pro uživatele
            if (copied) {
                btn.textContent = 'Zkopírováno!';
                setTimeout(() => { btn.textContent = 'Kopírovat'; }, 2000);
            }
        });
    </script>

</body>
</html>
